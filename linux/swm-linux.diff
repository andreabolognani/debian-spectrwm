opencvs server: Diffing inside .
Index: Makefile
===================================================================
RCS file: /scrotwm/scrotwm/linux/Makefile,v
retrieving revision 1.1
diff -N -u -p Makefile
--- Makefile	22 Jan 2009 23:12:27 -0000	1.1
+++ Makefile	7 Feb 2009 08:54:54 -0000
@@ -1,14 +1,25 @@
 # $scrotwm: Makefile,v 1.1 2009/01/22 23:12:27 marco Exp $ 
 
-CFLAGS+= -Wall -Wno-uninitialised -ggdb -D_GNU_SOURCE -I.
+CFLAGS+= -Wall -ggdb -D_GNU_SOURCE -I.
 LDADD+= -lX11 -lXrandr
 
 CC= gcc
 
-all: scrotwm
+LVERS= $(shell . ../lib/shlib_version; echo $$major.$$minor)
 
+all: symlink scrotwm libswmhack
+
+symlink:
+	ln -sf ../scrotwm.c ../lib/swm_hack.c .
+
 scrotwm: scrotwm.o linux.o
 	$(CC) $(LDFLAGS) -o $@ $+ $(LDADD)
 
+%.so: %.c
+	$(CC) $(CFLAGS) -c -fpic -DPIC $+ -o $@
+
+libswmhack: swm_hack.so
+	$(CC) -shared -fpic -o libswmhack.so.$(LVERS) `lorder swm_hack.so|tsort`
+
 clean:
-	rm -f *.o
+	rm -f scrotwm *.o *.so libswmhack.so.*
